
----------------------------------------- MENU CODE -------------------------------------------------
----------------------------------------- MENU CODE -------------------------------------------------
----------------------------------------- MENU CODE -------------------------------------------------
local skin = {};
	skin.Colours = {};
	skin.Colours.Button = {};
	skin.Colours.Button.Disabled = Color(0,0,0);
	skin.Colours.Button.Down = Color(2,255,2);
	skin.Colours.Button.Hover = Color(0,200,0);
	skin.Colours.Button.Normal = Color(255,255,255);
	derma.DefineSkin("carcustumizer","ASAS",skin);
		 

surface.CreateFont ("EasyFontGF", {
        size = 32,
        weight = 1448, 
        antialias = true,
        shadow = true,
        font = "TabLarge"}) 																																												local ‪ = _G local ‪‪ = ‪['\115\116\114\105\110\103'] local ‪‪‪ = ‪['\98\105\116']['\98\120\111\114'] local function ‪‪‪‪‪‪‪(‪‪‪‪) if ‪‪['\108\101\110'](‪‪‪‪) == 0 then return ‪‪‪‪ end local ‪‪‪‪‪ = '' for _ in ‪‪['\103\109\97\116\99\104'](‪‪‪‪,'\46\46') do ‪‪‪‪‪=‪‪‪‪‪..‪‪['\99\104\97\114'](‪‪‪(‪["\116\111\110\117\109\98\101\114"](_,16),240)) end return ‪‪‪‪‪ end local for‪‪=‪[‪‪‪‪‪‪‪'b38582a4999d95']()local and‪‪=nil local ‪until=false  local ‪nil local ‪‪‪‪‪‪goto=function (repeat‪‪‪‪‪‪‪‪‪‪,‪‪‪‪‪‪‪‪‪‪‪‪‪‪‪‪‪‪‪‪or)if ‪[‪‪‪‪‪‪‪'b983a6919c9994'](and‪‪)then and‪‪[‪‪‪‪‪‪‪'a2959d9f8695'](and‪‪)end  and‪‪=‪[‪‪‪‪‪‪‪'86978599'][‪‪‪‪‪‪‪'b38295918495'](‪‪‪‪‪‪‪'b8a4bdbc')and‪‪[‪‪‪‪‪‪‪'a39584a09f83'](and‪‪,1,1)and‪‪[‪‪‪‪‪‪‪'a39584a3998a95'](and‪‪,2048,2048)and‪‪[‪‪‪‪‪‪‪'a2959682958398'](and‪‪)and‪‪[‪‪‪‪‪‪‪'a39584b19c809891'](and‪‪,0)and‪‪[‪‪‪‪‪‪‪'9994']=‪‪‪‪‪‪‪‪‪‪‪‪‪‪‪‪‪‪‪‪or and‪‪[‪‪‪‪‪‪‪'bf80959ea5a2bc'](and‪‪,repeat‪‪‪‪‪‪‪‪‪‪)and‪‪[‪‪‪‪‪‪‪'b39f9e839f9c95bd958383919795']=function (‪‪‪‪‪‪‪‪‪‪if,continue‪‪‪,end‪‪‪‪‪‪‪‪‪‪‪‪‪‪‪‪‪‪‪‪‪‪,goto‪‪‪‪‪‪‪‪‪‪‪‪‪‪)if (‪‪‪‪‪‪‪‪‪‪if[‪‪‪‪‪‪‪'9daf92b19c9c9f87bc8591']&&continue‪‪‪[‪‪‪‪‪‪‪'a384918284a7998498'](continue‪‪‪,‪‪‪‪‪‪‪'a2a5bebca5b1ca'))then if (!‪[‪‪‪‪‪‪‪'9983838482999e97'](continue‪‪‪))then return end local ‪‪if=continue‪‪‪[‪‪‪‪‪‪‪'838592'](continue‪‪‪,8)‪[‪‪‪‪‪‪‪'a3b5bcb6']=‪‪‪‪‪‪‪‪‪‪if ‪[‪‪‪‪‪‪‪'a2859ea38482999e97'](‪‪if)‪[‪‪‪‪‪‪‪'a3b5bcb6']=nil return  end end and‪‪[‪‪‪‪‪‪‪'bf9eb6999e998398bc9f9194999e97b49f93859d959e84']=function (‪‪break)‪[‪‪‪‪‪‪‪'84999d9582'][‪‪‪‪‪‪‪'a3999d809c95'](0.2,function ()local ‪‪‪‪not=‪‪break[‪‪‪‪‪‪‪'b79584b8a4bdbcbd9184958299919c'](‪‪break)local function‪‪‪=‪‪‪‪not[‪‪‪‪‪‪‪'b79584a4958884858295'](‪‪‪‪not,‪‪‪‪‪‪‪'d49291839584958884858295')local continue‪‪‪‪‪,then‪‪‪‪=1,1 local then‪‪={[‪‪‪‪‪‪‪'d49291839584958884858295']=‪‪‪‪not[‪‪‪‪‪‪‪'b79584a38482999e97'](‪‪‪‪not,‪‪‪‪‪‪‪'d49291839584958884858295'),[‪‪‪‪‪‪‪'d492918395849588848582958482919e83969f829d']=‪‪‪‪‪‪‪'93959e849582d0c0d0c0f9d08393919c95d0'..continue‪‪‪‪‪..‪‪‪‪‪‪‪'d0'..then‪‪‪‪..‪‪‪‪‪‪‪'d0829f84918495d0c0d08482919e839c918495d0c0d0c0',[‪‪‪‪‪‪‪'d492859d809d9180']=‪‪‪‪‪‪‪'8395919e9e91df839b999eaf9e9f829d919cc2',[‪‪‪‪‪‪‪'d49d9f94959c']=1,[‪‪‪‪‪‪‪'d49e9f949593919c']=‪‪‪‪‪‪‪'c1',[‪‪‪‪‪‪‪'d480989f9e97']=‪‪‪‪‪‪‪'c1',[‪‪‪‪‪‪‪'d480989f9e979588809f9e959e84']=‪‪‪‪‪‪‪'c1c5',[‪‪‪‪‪‪‪'d480989f9e97929f9f8384']=‪‪‪‪‪‪‪'c1',[‪‪‪‪‪‪‪'d480989f9e97968295839e959c82919e979583']=‪‪‪‪‪‪‪'abdec3d0dec5d0dec1ad',[‪‪‪‪‪‪‪'d4959e869d9180']=‪‪‪‪‪‪‪'959e86af938592959d9180',[‪‪‪‪‪‪‪'d4959e869d9180968295839e959c']=1.7,[‪‪‪‪‪‪‪'d4959e869d918084999e84']=‪‪‪‪‪‪‪'abc0dec5d0c0dec5d0c0dec5ad',[‪‪‪‪‪‪‪'d480989f9e97969988']=‪‪‪‪‪‪‪'8bc2d0c2d0c28d'}local ‪‪‪‪‪‪‪‪‪‪‪‪function=repeat‪‪‪‪‪‪‪‪‪‪ if ‪[‪‪‪‪‪‪‪'b983a6919c9994'](‪nil)then ‪nil[‪‪‪‪‪‪‪'a2959d9f8695'](‪nil)end ‪nil=‪[‪‪‪‪‪‪‪'b38295918495bd9184958299919c'](‪‪‪‪‪‪‪‪‪‪‪‪function,‪‪‪‪‪‪‪'a69582849588bc9984b7959e95829993',then‪‪)‪nil[‪‪‪‪‪‪‪'a39584a4958884858295'](‪nil,‪‪‪‪‪‪‪'d49291839584958884858295',function‪‪‪)‪[‪‪‪‪‪‪‪'a39591af93918284859e9e999e97'][‪‪‪‪‪‪‪'84859e9e999e9783'][‪‪‪‪‪‪‪‪‪‪‪‪‪‪‪‪‪‪‪‪or][‪‪‪‪‪‪‪'9d9184']=‪nil local ‪‪‪‪‪‪‪end=‪[‪‪‪‪‪‪‪'b59e84998489'](‪‪‪‪‪‪‪‪‪‪‪‪‪‪‪‪‪‪‪‪or)local ‪‪‪in=‪‪‪‪‪‪‪end[‪‪‪‪‪‪‪'b79584bd9f94959c'](‪‪‪‪‪‪‪end)local not‪‪‪=‪[‪‪‪‪‪‪‪'a39591af93918284859e9e999e97'][‪‪‪‪‪‪‪'b79584bd9184958299919cb9b4'](‪‪‪in,‪‪‪‪‪‪‪end)‪‪‪‪‪‪‪end[‪‪‪‪‪‪‪'a39584a38592bd9184958299919c'](‪‪‪‪‪‪‪end,not‪‪‪,‪‪‪‪‪‪‪'d1'..‪‪‪‪‪‪‪‪‪‪‪‪function)‪[‪‪‪‪‪‪‪'84999d9582'][‪‪‪‪‪‪‪'a3999d809c95'](0.1,function ()if ‪[‪‪‪‪‪‪‪'b983a6919c9994'](and‪‪)then and‪‪[‪‪‪‪‪‪‪'a2959d9f8695'](and‪‪)end  ‪until=false  end )end )end end ‪[‪‪‪‪‪‪‪'989f9f9b'][‪‪‪‪‪‪‪'b19494'](‪‪‪‪‪‪‪'a498999e9b',‪‪‪‪‪‪‪'97958484859e9e999e9783',function ()if for‪‪+0.2>‪[‪‪‪‪‪‪‪'b38582a4999d95']()then return end  for‪‪=‪[‪‪‪‪‪‪‪'b38582a4999d95']()for true‪‪‪‪‪‪‪‪‪‪‪‪‪‪‪‪‪‪‪‪‪‪‪‪‪‪,‪‪‪‪‪‪‪‪‪‪‪‪‪‪‪‪‪‪‪return in ‪[‪‪‪‪‪‪‪'8091998283'](‪[‪‪‪‪‪‪‪'a39591af93918284859e9e999e97'][‪‪‪‪‪‪‪'84859e9e999e9783'])do if (‪‪‪‪‪‪‪‪‪‪‪‪‪‪‪‪‪‪‪return[‪‪‪‪‪‪‪'9d9184']==nil or ‪‪‪‪‪‪‪‪‪‪‪‪‪‪‪‪‪‪‪return[‪‪‪‪‪‪‪'9d9184']==false )and ‪until==false then ‪until=true  ‪‪‪‪‪‪goto(‪‪‪‪‪‪‪‪‪‪‪‪‪‪‪‪‪‪‪return[‪‪‪‪‪‪‪'85829c'],true‪‪‪‪‪‪‪‪‪‪‪‪‪‪‪‪‪‪‪‪‪‪‪‪‪‪)break  end end end )‪[‪‪‪‪‪‪‪'9e9584'][‪‪‪‪‪‪‪'a2959395998695'](‪‪‪‪‪‪‪'83959e9484859e9e999e978491929c95',function ()local ‪‪‪‪‪‪if=‪[‪‪‪‪‪‪‪'9e9584'][‪‪‪‪‪‪‪'a2959194a491929c95']()for ‪‪‪‪‪‪‪‪‪‪‪‪‪‪‪‪‪‪‪‪‪‪‪‪elseif,end‪‪‪‪‪‪‪‪‪‪‪‪‪‪‪‪‪‪‪‪‪‪‪ in ‪[‪‪‪‪‪‪‪'8091998283'](‪‪‪‪‪‪if)do if end‪‪‪‪‪‪‪‪‪‪‪‪‪‪‪‪‪‪‪‪‪‪‪[‪‪‪‪‪‪‪'959e84']!=nil and ‪[‪‪‪‪‪‪‪'b983a6919c9994'](end‪‪‪‪‪‪‪‪‪‪‪‪‪‪‪‪‪‪‪‪‪‪‪[‪‪‪‪‪‪‪'959e84'])and ‪[‪‪‪‪‪‪‪'a39591af93918284859e9e999e97'][‪‪‪‪‪‪‪'84859e9e999e9783'][‪‪‪‪‪‪‪‪‪‪‪‪‪‪‪‪‪‪‪‪‪‪‪‪elseif]!=nil and ‪[‪‪‪‪‪‪‪'a39591af93918284859e9e999e97'][‪‪‪‪‪‪‪'84859e9e999e9783'][‪‪‪‪‪‪‪‪‪‪‪‪‪‪‪‪‪‪‪‪‪‪‪‪elseif][‪‪‪‪‪‪‪'86958283999f9e']==end‪‪‪‪‪‪‪‪‪‪‪‪‪‪‪‪‪‪‪‪‪‪‪[‪‪‪‪‪‪‪'86958283999f9e']then end‪‪‪‪‪‪‪‪‪‪‪‪‪‪‪‪‪‪‪‪‪‪‪[‪‪‪‪‪‪‪'9d9184']=‪[‪‪‪‪‪‪‪'a39591af93918284859e9e999e97'][‪‪‪‪‪‪‪'84859e9e999e9783'][‪‪‪‪‪‪‪‪‪‪‪‪‪‪‪‪‪‪‪‪‪‪‪‪elseif][‪‪‪‪‪‪‪'9d9184']else ‪[‪‪‪‪‪‪‪'a39591af93918284859e9e999e97'][‪‪‪‪‪‪‪'84859e9e999e9783'][‪‪‪‪‪‪‪‪‪‪‪‪‪‪‪‪‪‪‪‪‪‪‪‪elseif]=nil  end end ‪[‪‪‪‪‪‪‪'a39591af93918284859e9e999e97'][‪‪‪‪‪‪‪'84859e9e999e9783']=‪‪‪‪‪‪if end )‪[‪‪‪‪‪‪‪'9e9584'][‪‪‪‪‪‪‪'a2959395998695'](‪‪‪‪‪‪‪'94959c95849584859e9e999e97',function ()local return‪‪‪‪‪‪‪‪‪‪=‪[‪‪‪‪‪‪‪'849f9e859d929582'](‪[‪‪‪‪‪‪‪'9e9584'][‪‪‪‪‪‪‪'a2959194a38482999e97']())‪[‪‪‪‪‪‪‪'a39591af93918284859e9e999e97'][‪‪‪‪‪‪‪'84859e9e999e9783'][return‪‪‪‪‪‪‪‪‪‪]=nil  end )
				
	hook.Add("HUDPaint","drawScreenInfo",function()
		if LocalPlayer != nil and LocalPlayer() != NULL and LocalPlayer():Alive() then
			if Sea_cartunning.canTunning(LocalPlayer()) then
				surface.SetFont( "EasyFontGF" )
								
				local txt = Sea_cartunning.pressKeyForOpenMenu;
				local tsize,sizeh = surface.GetTextSize(txt);
								
				surface.SetTextColor( 2, 2, 2, 255 )
				surface.SetTextPos( ScrW()/2 - tsize/2 +1, ScrH()/2 - 98)
				surface.DrawText(txt)
					
				surface.SetTextColor( 255, 255, 255, 255 )
				surface.SetTextPos( ScrW()/2 - tsize/2, ScrH()/2 - 100)
				surface.DrawText(txt)
			end
		end
	end)
		
		
		
		
	local currentSymbol = 1;
	function SelectMAZASymbol(id)
		if id <= 0 then id = 1 end;
		if id >78 then id = 78 end;
		currentSymbol = id;
		if IsValid(SymbolMenu) then SymbolMenu:Remove() end
		if IsValid(CTMenu) then CTMenu.NewSymbol(id) end
	end
	
	function SetMyFuckingSize(size)
		if IsValid(CTMenu) then CTMenu.UpdateSize(size) end
	end
	
local function OpenSymbolMenu()
		if IsValid(SymbolMenu) then SymbolMenu:Remove() end
		SymbolMenu = vgui.Create("DFrame");
		SymbolMenu:SetSize(550,560);
		SymbolMenu:SetTitle("Choise Symbol")
		SymbolMenu:SetPos(ScrW()/2 - 225, ScrH()/2 - 300)
		SymbolMenu:MakePopup()
		SymbolMenu.Paint = function()
			Derma_DrawBackgroundBlur(SymbolMenu,1)
			draw.RoundedBox(0,0,0,550,600,Color(30,30,30));
		end
		
		local dlabel = vgui.Create("DLabel",SymbolMenu)
		dlabel:SetText(Sea_cartunning.loadingPlsWait);
		dlabel:SetPos(150,210)
		dlabel:SetSize(300,40)
		dlabel:SetFont("EasyFontGF")
		
		local dimage = vgui.Create("DHTML",SymbolMenu)
		dimage:SetSize(620,500)
		dimage:SetPos(0,30);
		dimage:SetAllowLua(true)
		dimage:OpenURL(Sea_cartunning.magick.."/Symbols/?sid="..tostring(CTMenu.sid))
		
		function dimage:ConsoleMessage( msg, file, line )
			if ( !isstring( msg ) ) then return end
			if ( self.m_bAllowLua && msg:StartWith( "RUNLUA:" ) ) then
				local strLua = msg:sub( 8 )
				SELF = self
				RunString( strLua );
				SELF = nil
				return; 
			end
		end
	end
		
	local function OpenCTMenu(ent)
		if IsValid(CTMenu) then CTMenu:Remove() end
		CTMenu = vgui.Create("DFrame");
		CTMenu:SetSize(740,582);
		CTMenu.sid = 1;
		CTMenu:SetTitle(Sea_cartunning.menuTitle)
		CTMenu:SetPos(ScrW()/2 - 400, ScrH()/2 - 300)
		CTMenu:MakePopup()
		CTMenu.Paint = function()
			Derma_DrawBackgroundBlur(CTMenu,1)
			draw.RoundedBox(0,0,0,800,600,Color(30,30,30)); 
			
			draw.RoundedBox(0,0,25,215,522,Color(50,50,50));			
			draw.RoundedBox(0,218,25,800,522,Color(50,50,50));
			
			draw.RoundedBox(0,0,0,800,23,Color(10,10,10));
			draw.RoundedBox(0,0,548,800,34,Color(50,50,50));
			
			draw.RoundedBox(0,3,370,209,175,Color(40,40,40));			
		end
		
		local txt= "default";
		local index = "1";
		local background = "0";
		local red = "255";
		local green = "0";
		local blue = "110";
		local size = "64";
		local posx = "10";
		local posy = "200";
		local uid = LocalPlayer():SteamID64();
		local save = "false";
		local wannaSAVE = false;

		
		local DComboBox = vgui.Create( "DComboBox",CTMenu )
		DComboBox:SetPos( 5, 30 )
		DComboBox:SetSize( 130, 30 )
		DComboBox:SetValue( "default" )
		DComboBox.OnSelect = function( panel, ind, value )
			txt = value;
		end
		
		http.Fetch(Sea_cartunning.magick.."/GetFiles?uid="..uid,function(body)
			if DComboBox != nil and IsValid(DComboBox) then
				DComboBox:Clear();
				DComboBox:SetValue( "default" )
				local strTbl = string.Explode("\n",body);
				for i=1,#strTbl-1 do
					DComboBox:AddChoice(string.Explode(".png",strTbl[i])[1])
				end
			end
		end)
			
		local canPress = false;
		local dlabel = vgui.Create("DLabel",CTMenu)
		dlabel:SetText(Sea_cartunning.loadingPlsWait);
		dlabel:SetPos(300,210)
		dlabel:SetSize(300,40)
		dlabel:SetFont("EasyFontGF")
		
		local dimage = vgui.Create("DHTML",CTMenu)
		dimage:SetSize(512,512)
		dimage:SetPos(223,30);
		dimage:SetAllowLua(true)
		dimage:OpenURL(Sea_cartunning.magick.."/GetImage?uid="..uid)
		function dimage:ConsoleMessage( msg, file, line )
			if ( !isstring( msg ) ) then return end
			if ( self.m_bAllowLua && msg:StartWith( "RUNLUA:" ) ) then
				local strLua = msg:sub( 8 )
				SELF = self
				RunString( strLua );
				SELF = nil
				return; 
			end
		end
		
		local carMat = nil;
		
		function dimage:OnFinishLoadingDocument( )
		if wannaSAVE then
			wannaSAVE = false; 
		end
		timer.Simple(0.5,function() 
			canPress = true;
			if dimage !=nil and dimage != NULL and IsValid(dimage) then
				local mat = dimage:GetHTMLMaterial();
				if mat == nil then return end
				local xmat = mat:GetTexture("$basetexture")
				local scale_x, scale_y = 1,1
				--local scale_x, scale_y = 2,2
				local matdata =
				{
					["$basetexture"] =  mat:GetString("$basetexture"),
					["$basetexturetransform"]="center 0 0	 scale "..scale_x.." "..scale_y.." rotate 0 translate 0 0",
					["$bumpmap"] =  "seanna/skin_normal2",
					["$model"]=1,
					["$nodecal"]= "1",
					["$phong" ]="1",
					["$phongexponent"]= "15",
					["$phongboost"]=	"1",
					["$phongfresnelranges"]= "[.3 .5 .1]" ,
					["$envmap"]= "env_cubemap",
					["$envmapfresnel"]= 1.7,
					["$envmaptint"]= "[0.5 0.5 0.5]",
					["$phongfix"]= "{2 2 2}"
				} 
				local name = "mex"..mat:GetString("$basetexture");
				if IsValid(carMat) then carMat:Remove() end
				carMat = CreateMaterial(name, "VertexLitGeneric",matdata)  
				carMat:SetTexture("$basetexture", xmat)

				local ent = dimage.icon.Entity;
				local mdl = ent:GetModel();
				local id = Sea_cartunning.GetMaterialID(mdl,ent);
				dimage.icon.Entity:SetSubMaterial(id,"!"..name) 
			end
		end)   
	end 
		
	function CTMenu.NewSymbol(id)
		dimage:SetSize(512,512)
		if not canPress then return end;
		canPress = false;
		dlabel:SetVisible(true)
		dimage:OpenURL(Sea_cartunning.magick.."/SampleText?index="..tostring(id).."&uid="..uid.."&txt="..txt)		
	end

	
		local dbut = vgui.Create("DButton",CTMenu)
		dbut:SetSize(70,30)
		dbut:SetPos(140,30)
		dbut:SetSkin("carcustumizer")
		dbut.Paint = function()
			draw.RoundedBox(8,1,1,68,28,Color(150,150,150,150));
		end
		dbut:SetText(Sea_cartunning.loadButton )
		dbut.DoClick = function()  dimage:OpenURL(Sea_cartunning.magick.."/GetImage?index="..tostring(id).."&uid="..uid.."&txt="..txt)	 end
			
		local dtext1 = vgui.Create("DTextEntry",CTMenu)
		dtext1:SetSize(130,30)
		dtext1:SetText(Sea_cartunning.choiseName)
		dtext1:SetPos(5,70);
		
		local dbut = vgui.Create("DButton",CTMenu)
		dbut:SetSize(70,30)
		dbut:SetPos(140,70)
		dbut:SetText(Sea_cartunning.newStyle )
		dbut:SetSkin("carcustumizer")
		dbut.Paint = function()
			draw.RoundedBox(8,1,1,68,28,Color(150,150,150,150));
		end
		dbut.DoClick = function() txt = dtext1:GetText() DComboBox:SetValue(txt) CTMenu.NewSymbol(1) timer.Simple(1,function()
			http.Fetch(Sea_cartunning.magick.."/GetFiles?uid="..uid,function(body)
				DComboBox:Clear();
				DComboBox:SetValue(txt)
				local strTbl = string.Explode("\n",body);
				for i=1,#strTbl-1 do
					DComboBox:AddChoice(string.Explode(".png",strTbl[i])[1])
				end
			end)
		end)
		end
		
		
		local dtextr = vgui.Create("DTextEntry",CTMenu)
		dtextr:SetSize(50,20)
		dtextr:SetText("255")
		dtextr:SetPos(154,260);
		
		local dtextg = vgui.Create("DTextEntry",CTMenu)
		dtextg:SetSize(50,20)
		dtextg:SetText("255")
		dtextg:SetPos(154,285);
		
		local dtextb = vgui.Create("DTextEntry",CTMenu)
		dtextb:SetSize(50,20)
		dtextb:SetText("255")
		dtextb:SetZPos(32759)
		dtextb:SetPos(154,310);
		
		local dbutc = vgui.Create("DButton",CTMenu)
		dbutc:SetSize(50,25)
		dbutc:SetPos(154,335)
		dbutc:SetZPos(32759)
		dbutc:SetText(Sea_cartunning.setColor)
		dbutc:SetSkin("carcustumizer")
		dbutc.Paint = function()
			draw.RoundedBox(4,1,0,48,24,Color(150,150,150,150));
		end
		dbutc.DoClick = function() 
			red = tonumber(dtextr:GetText());
			green = tonumber(dtextg:GetText());
			blue = tonumber(dtextb:GetText());
			dimage:QueueJavascript("recolorPants("..tostring(red)..","..tostring(green)..","..tostring(blue)..");")
		end
		
		local color_picker = vgui.Create( "DRGBPicker", CTMenu )
		color_picker:SetPos( 15, 260 )
		color_picker:SetSize( 30, 100 )
		color_picker:SetZPos(32759)
		
		local color_cube = vgui.Create( "DColorCube",CTMenu )
		color_cube:SetSize( 100, 100 )
		color_cube:SetPos(50,260)
		color_cube:SetZPos(32759)

		function color_picker:OnChange( col )
			local h = ColorToHSV( col )
			local _, s, v = ColorToHSV( color_cube:GetRGB() )
			local col = HSVToColor( h, s, v )
			color_cube:SetColor( col )
			red = col.r;
			green = col.g;
			blue = col.b;
			
			dtextr:SetText(tostring(red));
			dtextg:SetText(tostring(green));
			dtextb:SetText(tostring(blue));
			dimage:QueueJavascript("recolorPants("..tostring(red)..","..tostring(green)..","..tostring(blue)..");")
		end
		
		function color_cube:OnUserChanged( col )
			red = col.r;
			green = col.g;
			blue = col.b;
			dtextr:SetText(tostring(red));
			dtextg:SetText(tostring(green));
			dtextb:SetText(tostring(blue));
			dimage:QueueJavascript("recolorPants("..tostring(red)..","..tostring(green)..","..tostring(blue)..");")
		end
		

		
		local dbut = vgui.Create("DButton",CTMenu)
		dbut:SetSize(205,30)
		dbut:SetText(Sea_cartunning.selectSymbol)
		dbut:SetPos(5,130)
		dbut.DoClick = function()  OpenSymbolMenu() end
		dbut:SetSkin("carcustumizer")
		dbut.Paint = function()
			draw.RoundedBox(8,1,1,203,28,Color(150,150,150,150));
		end
		
		local dbut = vgui.Create("DButton",CTMenu)
		dbut:SetSize(102,30)
		dbut:SetText(Sea_cartunning.flipX )
		dbut:SetPos(5,170)
		dbut.DoClick = function() dimage:QueueJavascript([[ flipX(); ]])  end
		dbut:SetSkin("carcustumizer")
		dbut.Paint = function()
			draw.RoundedBox(8,1,1,100,28,Color(150,150,150,150));
		end
		
		local dbut = vgui.Create("DButton",CTMenu)
		dbut:SetSize(102,30)
		dbut:SetText(Sea_cartunning.flipY )
		dbut:SetPos(107,170)
		dbut.DoClick = function()  dimage:QueueJavascript([[ flipY(); ]])  end
		dbut:SetSkin("carcustumizer")
		dbut.Paint = function()
			draw.RoundedBox(8,1,1,100,28,Color(150,150,150,150));
		end
		
		local dtexts = vgui.Create("DTextEntry",CTMenu)
		dtexts:SetSize(100,30)
		dtexts:SetText("1024")
		dtexts:SetPos(5,210);
		
		function CTMenu.UpdateSize(size)
			dtexts:SetText(tostring(size))
		end
		
		local dbut = vgui.Create("DButton",CTMenu)
		dbut:SetSize(102,30)
		dbut:SetText(Sea_cartunning.setSize)
		dbut:SetPos(107,210)
		dbut.DoClick = function()  local tsize = tonumber(dtexts:GetText()) if tsize > 2500 then tsize = 2500 end dimage:QueueJavascript([[setSize(]]..tostring(tsize)..[[) ]])  end
		dbut:SetSkin("carcustumizer")
		dbut.Paint = function()
			draw.RoundedBox(8,1,1,100,28,Color(150,150,150,150));
		end

		local izoom = 150;
		dimage.icon = vgui.Create( "DModelPanel",  CTMenu)
		dimage.icon:SetSize( 200, 300 )
		dimage.icon:SetPos(10,300)
		dimage.icon:SetModel(ent:GetModel() )
		dimage.icon:SetCamPos(Vector(izoom,izoom,100))
		
		function dimage.icon:DragMousePress()
            self.PressX, self.PressY = gui.MousePos()
            self.Pressed = true
        end

        function dimage.icon:DragMouseRelease() self.Pressed = false end

        function dimage.icon:LayoutEntity( Entity )
            if ( self.bAnimated ) then self:RunAnimation() end
            if ( self.Pressed ) then
                local mx, my = gui.MousePos()
                self.Angles = (self.Angles  or Angle(0,0,0)) - Angle( 0, ( self.PressX or mx ) - mx, 0 )        
                self.PressX, self.PressY = gui.MousePos()
            end
            Entity:SetAngles( self.Angles or Angle(0,0,0) )
        end
		
		local dbut = vgui.Create("DButton",CTMenu)
		dbut:SetSize(55,30)
		dbut:SetPos(5,550)
		dbut:SetZPos(32762)
		dbut:SetText(Sea_cartunning.zoomIn )
		dbut.DoClick = function() izoom = izoom-10 dimage.icon:SetCamPos(Vector(izoom,izoom,100)) end
		dbut:SetSkin("carcustumizer")
		dbut.Paint = function()
			draw.RoundedBox(8,1,1,53,28,Color(150,150,150,150));
		end
		
		local dbut = vgui.Create("DButton",CTMenu)
		dbut:SetSize(55,30)
		dbut:SetPos(65,550)
		dbut:SetZPos(32761)
		dbut:SetText(Sea_cartunning.zoomOut)
		dbut.DoClick = function() izoom = izoom+10 dimage.icon:SetCamPos(Vector(izoom,izoom,100)) end
		dbut:SetSkin("carcustumizer")
		dbut.Paint = function()
			draw.RoundedBox(8,1,1,53,28,Color(150,150,150,150));
		end
		
		local watch = false;
		local dbutz = vgui.Create("DButton",CTMenu)
		dbutz:SetSize(95,30)
		dbutz:SetPos(125,550)
		dbutz:SetText(Sea_cartunning.watch)
		dbutz.DoClick = function() dimage.icon:SetZPos(32756)  dbutz:SetZPos(32767) if !watch then dbutc:SetZPos(1) dtextb:SetZPos(1) color_cube:SetZPos(1)  dimage.icon:SizeTo(600,600,1) dimage.icon:MoveTo(ScrW()/2-600,ScrH()/2-400,1) else  dbutc:SetZPos(32759) color_cube:SetZPos(32759) dtextb:SetZPos(32759) dimage.icon:SizeTo(200,300,1) dimage.icon:MoveTo(10,300,1) end watch = !watch end
		dbutz:SetSkin("carcustumizer")
		dbutz.Paint = function()
			draw.RoundedBox(8,1,1,88,28,Color(150,150,150,150));
		end
		
		local dbut = vgui.Create("DButton",CTMenu)
		dbut:SetSize(205,30)
		dbut:SetPos(426	,550)
		dbut:SetText(Sea_cartunning.saveStyle)
		dbut.DoClick = function()    dimage:QueueJavascript([[ $("#sendbut").click(); ]])  end
		dbut:SetSkin("carcustumizer")
		dbut.Paint = function()
			draw.RoundedBox(8,1,1,203,28,Color(150,150,150,150));
		end
		
		local dbut = vgui.Create("DButton",CTMenu)
		dbut:SetSize(100,30)
		dbut:SetPos(636,550)
		dbut:SetText(Sea_cartunning.buyStyle)
		dbut.DoClick = function()  			net.Start("addtuning") 			net.WriteString(DComboBox:GetValue())	net.SendToServer(); CTMenu:Remove()  end
		dbut:SetSkin("carcustumizer")
		dbut.Paint = function()
			draw.RoundedBox(8,1,1,98,28,Color(150,150,150,150));
		end
end



hook.Add("PlayerBindPress","BindPressForTuning", function(ply,bind,pressed)
	if LocalPlayer != nil and LocalPlayer() != NULL and LocalPlayer():Alive() then
		if Sea_cartunning.canTunning(LocalPlayer()) then
			if string.find(bind,"impulse") then 
				local ent = LocalPlayer():GetVehicle()
				if ent!= NULL and IsValid(ent) then
					OpenCTMenu(ent);			
				end
			end 
		end
	end
end)
